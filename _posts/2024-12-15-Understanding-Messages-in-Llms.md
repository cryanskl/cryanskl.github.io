---
title: "Understanding Messages in LLMs"
date: 2024-12-15 22:15:38 +0800
categories: [LLM]
tags: [llm]
pin: false
---

## 1. Messages çš„ç§ç±»

åœ¨ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ OpenAI çš„ GPT ç³»åˆ—ï¼‰äº¤äº’æ—¶ï¼Œæ¶ˆæ¯ï¼ˆ`messages`ï¼‰é€šå¸¸ç”±ä»¥ä¸‹ä¸‰ç§è§’è‰²ç»„æˆï¼š

- `user`ï¼šä»£è¡¨ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼›
- `assistant`ï¼šä»£è¡¨æ¨¡å‹ç”Ÿæˆçš„å›å¤ï¼›
- `system`ï¼šç”¨äºè®¾å®šåŠ©æ‰‹è¡Œä¸ºçš„åˆå§‹æŒ‡ä»¤ï¼Œå¯¹æ•´ä¸ªå¯¹è¯çš„è¯­æ°”ä¸è§’è‰²æœ‰é‡è¦å½±å“ã€‚

è¿™äº›æ¶ˆæ¯ä»¥åˆ—è¡¨å½¢å¼æŒ‰é¡ºåºç»„ç»‡ï¼Œç”¨äºæ„å»ºä¸Šä¸‹æ–‡å¯¹è¯ã€‚

## 2. user æ¶ˆæ¯

ç”¨æˆ·æ¶ˆæ¯ç”¨äºå‘æ¨¡å‹æå‡ºè¯·æ±‚æˆ–æé—®ã€‚æ ¼å¼å¦‚ä¸‹ï¼š

```
pythonCopyEdit# åˆ›å»ºç”¨æˆ·æ¶ˆæ¯
user_message = {
    "role": "user",
    "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸‹ä½ è‡ªå·±ã€‚"
}
```

## 3. assistant æ¶ˆæ¯

åŠ©æ‰‹æ¶ˆæ¯è¡¨ç¤ºæ¨¡å‹çš„å›å¤ï¼Œé€šå¸¸ç´§è·Ÿåœ¨ç”¨æˆ·æ¶ˆæ¯ä¹‹åï¼Œç”¨äºè®°å½•æ¨¡å‹å†å²å“åº”ï¼Œä»¥ä¿æŒå¯¹è¯çš„ä¸Šä¸‹æ–‡ã€‚

```
pythonCopyEdit# åˆ›å»ºåŠ©æ‰‹æ¶ˆæ¯
assistant_message = {
    "role": "assistant",
    "content": "ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªç”± OpenAI è®­ç»ƒçš„å¤§è¯­è¨€æ¨¡å‹ï¼Œå¯ä»¥å¸®åŠ©ä½ è§£ç­”é—®é¢˜ã€æ’°å†™å†…å®¹ç­‰ã€‚"
}
```

## 4. system æ¶ˆæ¯

System æ¶ˆæ¯ç”¨äºè®¾å®šå¯¹è¯çš„åˆå§‹è¡Œä¸ºå’Œè¯­å¢ƒï¼Œä¾‹å¦‚è¦æ±‚æ¨¡å‹æ‰®æ¼”æŸç§èº«ä»½ã€ä½¿ç”¨æŸç§è¯­è¨€é£æ ¼ç­‰ã€‚å®ƒä¸ä¼šæ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œä½†å¯¹åç»­å›å¤æœ‰æ˜¾è‘—å½±å“ã€‚

é™¤äº†è®¾å®šåŠ©æ‰‹è¡Œä¸ºï¼Œ`system` æ¶ˆæ¯è¿˜å¸¸ç”¨äº Function Calling åœºæ™¯ä¸­æä¾›å‡½æ•°å®šä¹‰ä¿¡æ¯ã€‚

### å¤šè½®å¯¹è¯æœºå™¨äººç¤ºä¾‹

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å¤šè½®å¯¹è¯å®ç°ï¼Œæ¼”ç¤ºå¦‚ä½•é€šè¿‡ `messages` åˆ—è¡¨æ„å»ºä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸æ¨¡å‹æŒç»­å¯¹è¯ï¼š

```
pythonCopyEditdef multi_round_chat():
    """
    å¤šè½®å¯¹è¯æœºå™¨äººç¤ºä¾‹å‡½æ•°ï¼Œæ¼”ç¤ºå¦‚ä½•æŒç»­ç»´æŠ¤æ¶ˆæ¯ä¸Šä¸‹æ–‡å¹¶è°ƒç”¨è¯­è¨€æ¨¡å‹ç”Ÿæˆå›å¤ã€‚
    """
    messages = []

    # æ·»åŠ ç³»ç»Ÿæ¶ˆæ¯ï¼Œè®¾å®šåŠ©æ‰‹è§’è‰²
    system_message = create_message("system", "You are a helpful assistant.")
    messages.append(system_message)

    while True:
        # è·å–ç”¨æˆ·è¾“å…¥
        user_input = input("User: ")

        if user_input.lower() == 'exit':
            print("å¯¹è¯ç»“æŸã€‚")
            break

        # æ„å»ºç”¨æˆ·æ¶ˆæ¯
        user_message = create_message("user", user_input)
        messages.append(user_message)

        # è°ƒç”¨æ¨¡å‹ç”ŸæˆåŠ©æ‰‹å›å¤ï¼ˆéœ€ç»“åˆå®é™… APIï¼‰
        assistant_reply = chat_with_DeepSeek(client, messages)
        display(Markdown(f"Assistant: {assistant_reply}"))

        # ä¿å­˜åŠ©æ‰‹æ¶ˆæ¯
        messages.append(create_message("assistant", assistant_reply))
```

> ğŸ’¡ å»ºè®®å°† `create_message` å’Œ `chat_with_DeepSeek` å‡½æ•°å°è£…å¥½ï¼Œå¹¶æ ¹æ®å…·ä½“ LLM æä¾›æ–¹ï¼ˆå¦‚ OpenAIã€DeepSeek ç­‰ï¼‰æ›¿æ¢è°ƒç”¨æ–¹å¼ã€‚
