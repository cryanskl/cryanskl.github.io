---
title: "Custom Domain with Alibaba Cloud CDN"
date: 2024-10-05 18:24:37 +0800
categories: [Lab]
tags: [website, alicloud]
pin: false
---

## 1.ç»•å¼€é™åˆ¶

åŸºäºæŸäº›å®¢è§‚åŸå› , å‘ç°è¿é€šæ€§å¾ˆå·®. æ‰€ä»¥ç”¨ **é˜¿é‡Œäº‘ CDN + GitHub Pages + è‡ªå®šä¹‰åŸŸåç»‘å®š** çš„æ–¹å¼è§£å†³

ä»¥ä¸‹æ˜¯æ‰¾GPTç”Ÿæˆçš„æ“ä½œæµç¨‹, é…ä¸Šè‡ªå·±çš„è¿‡ç¨‹å›¾.

### âœ… æ­¥éª¤ 1ï¼šè®¾ç½® GitHub Pages è‡ªå®šä¹‰åŸŸå

1. æ‰“å¼€ä½ çš„ GitHub é¡¹ç›®ï¼ˆä¾‹å¦‚ï¼š`yourusername.github.io`ï¼‰
2. è¿›å…¥ `Settings > Pages`
3. åœ¨ **Custom domain** æ é‡Œå¡«ä¸Šä½ çš„åŸŸåï¼ˆå¦‚ï¼š`www.yourdomain.com`ï¼‰
4. GitHub ä¼šè‡ªåŠ¨åœ¨ä»“åº“æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª `CNAME` æ–‡ä»¶ï¼Œå†…å®¹ä¸ºä½ çš„åŸŸå
5. âš ï¸ ç­‰ GitHub éƒ¨ç½²å®Œæˆï¼ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰

PS:å…¶å®è¿™é‡Œæˆ‘æ²¡ç»†çœ‹, å…ˆåšåé¢.è¿™é‡Œå› ä¸ºæ²¡æœ‰é…ç½®dnså’Œcdn, ä¸€å®šä¼šæŠ¥é”™

------

### âœ… æ­¥éª¤ 2ï¼šå¼€é€šé˜¿é‡Œäº‘ CDN å¹¶ç»‘å®šåŸŸå

1. æ‰“å¼€ é˜¿é‡Œäº‘ CDN æ§åˆ¶å°
2. ç‚¹å‡»ã€Œæ·»åŠ åŸŸåã€
   - åŠ é€ŸåŸŸåå¡«å†™ä½ çš„åŸŸåï¼Œä¾‹å¦‚ `www.yourdomain.com`
     - ==è¯·æ³¨æ„, è¿™é‡Œä¼šè®©ä½ åœ¨åˆšæ‰DNSåŠ ä¸€ä¸ªTXTç±»å‹, å¯ä»¥ç‚¹å‡»å¸®åŠ©æ–‡æ¡£, å†™çš„å¾ˆè¯¦ç»†==
   - åŠ é€Ÿç±»å‹ï¼šé€‰æ‹©ã€Œå›¾ç‰‡å°æ–‡ä»¶ã€
   - æºç«™ç±»å‹ï¼šé€‰æ‹©ã€ŒåŸŸåã€
   - æºç«™åœ°å€ï¼šå¡«å†™ `yourusername.github.io`
   - å›æºåè®®ï¼šç«¯å£443
3. æ·»åŠ æˆåŠŸåï¼Œé˜¿é‡Œäº‘ä¼šæç¤ºä½ å°† `CNAME` æŒ‡å‘ä¸€ä¸ª CDN åŸŸåï¼ˆä¾‹å¦‚ `xxx.aliyuncdn.com`ï¼‰

------

### âœ… æ­¥éª¤ 3ï¼šä¿®æ”¹ DNSï¼ŒæŠŠåŸŸå CNAME æŒ‡å‘é˜¿é‡Œäº‘ CDN

å»é˜¿é‡Œäº‘ DNS è§£ææ§åˆ¶å°ï¼š

- ä¿®æ”¹æˆ–æ–°å¢ä¸€æ¡ `CNAME` è®°å½•ï¼š

| ç±»å‹    | ä¸»æœºè®°å½• | è®°å½•å€¼                                              |
| ------- | -------- | --------------------------------------------------- |
| `CNAME` | `www`    | `xxx.aliyuncdn.com` ï¼ˆé˜¿é‡Œäº‘æä¾›çš„ CDN CNAME åœ°å€ï¼‰ |

ç­‰å¾…è§£æç”Ÿæ•ˆï¼ˆé€šå¸¸å‡ åˆ†é’Ÿï¼‰

------

### âœ… æ­¥éª¤ 4ï¼šå¼€å¯ HTTPS

åœ¨é˜¿é‡Œäº‘ CDN æ§åˆ¶å°ï¼š

1. æ‰¾åˆ°ä½ ç»‘å®šçš„åŸŸåï¼Œç‚¹å‡»è¿›å…¥é…ç½®
2. é€‰æ‹©ã€Œè¯ä¹¦ç®¡ç†ã€æˆ–ã€ŒHTTPS é…ç½®ã€
3. å¦‚æœä½ æ²¡æœ‰è¯ä¹¦ï¼Œå¯ä»¥é€‰æ‹©ç”³è¯·å…è´¹çš„ **é˜¿é‡Œäº‘æ‰˜ç®¡è¯ä¹¦**
4. å¡«å†™åŸŸåç­‰ä¿¡æ¯åï¼Œè‡ªåŠ¨ç”Ÿæˆå¹¶é…ç½® HTTPS
5. å›åˆ°CDNæ§åˆ¶å°è¿›è¡Œé…ç½®

------

### âœ… å®Œæˆï¼

æ­¤æ—¶ä½ è®¿é—® `https://www.yourdomain.com`ï¼Œå°±ä¼šé€šè¿‡é˜¿é‡Œäº‘ CDN åŠ é€Ÿè®¿é—®ä½ çš„ GitHub Pages é¡µé¢ï¼Œä¸”å®Œå…¨**ä¸å†å— github.io å±è”½çš„å½±å“**äº† ğŸ‰

## 2.å¸¸è§é—®é¢˜

### 2.1.DNS Checkéœ€è¦github.ioä½œä¸ºCNAME

å¦‚æœç”¨äº†è¿™ä¸ªä¸ºCNAME, å°±æ²¡æœ‰ç”¨åˆ°CDN, é‚£ä¹ˆè¿™ä¸ªé…ç½®ç…§æ ·æ— æ³•é¡ºç•…è®¿é—®



### 2.2.é»˜è®¤é¡µé¢index.html

å½“ä½ é…ç½®å®Œ, ç›´æ¥è®¿é—®é¦–é¡µ, å‘ç°å†…å®¹æ˜¯

æ˜¯æ²¡æœ‰æ¸²æŸ“çš„mdæ–‡æ¡£, è€Œå…¶ä»–æ–‡ä»¶å¯ä»¥æ­£å¸¸è®¿é—®.

GPTè§£ç­”å¦‚ä¸‹:

#### ğŸ¯ é—®é¢˜æœ¬è´¨ï¼šé˜¿é‡Œäº‘ CDN å›æºé¦–é¡µæ—¶ï¼Œè¿”å›çš„æ˜¯æºä»£ç ï¼Œè€Œä¸æ˜¯æ„å»ºåçš„ `index.html`

ä¹Ÿå°±æ˜¯ï¼š

- ä½ è®¿é—® `https://www.wuzhixiaojiu.com/` æ—¶
  - CDN å»å›æº `cryanskl.github.io/`
  - ä½†å¯èƒ½é”™è¯¯åœ°å–åˆ°äº†ä»“åº“çš„ `index.md` æºæ–‡ä»¶
  - è€Œä¸æ˜¯çœŸæ­£æ„å»ºç”Ÿæˆçš„ `index.html`

> æ‰€ä»¥ä½ çœ‹åˆ°çš„å°±å˜æˆäº†åŸå§‹ Markdown æ–‡ä»¶å†…å®¹ï¼Œè€Œéæ¸²æŸ“ç»“æœã€‚

------

#### âœ… ä¸ºä»€ä¹ˆå…¶ä»–é¡µé¢å¯ä»¥æ­£å¸¸è®¿é—®ï¼Ÿ

å› ä¸º GitHub Pages ç”Ÿæˆåçš„é¡µé¢è·¯å¾„æ˜¯ï¼š

- `index.html` â† é¦–é¡µ
- `/about/` â†’ `about/index.html`
- `/posts/foo/` â†’ `posts/foo/index.html`

è¿™äº›è·¯å¾„åœ¨ CDN ä¸­ä¸ä¼šå†²çªåˆ° Markdown æ–‡ä»¶åï¼Œè€Œé¦–é¡µ `/` å¾ˆå®¹æ˜“è¢« CDN é”™è¯¯æ˜ å°„åˆ° `index.md`ï¼ˆè€Œä¸æ˜¯ `index.html`ï¼‰ï¼Œ**å°¤å…¶æ˜¯åœ¨â€œå›æº Host å¤´â€æ²¡è®¾ç½®æ­£ç¡®æ—¶**ã€‚

#### è§£å†³æ–¹æ¡ˆ

åœ¨æ ¹ç›®å½• index.html é‡ŒåŠ ä¸Š

```python
---
layout: home
permalink: /
---

<script>
  (function() {
    const isLocalhost = window.location.hostname === 'localhost' || 
                        window.location.hostname === '127.0.0.1' || 
                        window.location.hostname.startsWith('192.168.') || 
                        window.location.protocol === 'file:';

    const isRootPath = window.location.pathname === '/' || window.location.pathname === '/index.html';

    if (!isLocalhost && isRootPath) {
      window.location.href = '/index.html';
    }
  })();
</script>

<noscript>
  å¦‚æœæ²¡æœ‰è·³è½¬ï¼Œè¯·ç‚¹å‡» <a href="/index.html">è¿™é‡Œ</a>ã€‚
</noscript>

```

